---
title: "Case study: How does a bike-share navigate speedy success?"
author: "Agnieszka Gresham"
date: "2024-02-19"
output:
  html_document: default
  word_document: default
  pdf_document: default
---

# Introduction

This is Capstone Project as part of my course "Google Data Analytics Professional Certificate",
For this scenario, for analysis I will be using Program R, for statistics and visualization the insights



## Scenario

You are a junior data analyst working on the marketing analyst team at Cyclistic, a bike-share company in Chicago. The director of marketing believes the company’s future success depends on maximizing the number of annual memberships. Therefore, your team wants to understand how casual riders and annual members use Cyclistic bikes differently. From these insights, your team will design a new marketing strategy to convert casual riders into annual members. But first, Cyclistic executives must approve your recommendations, so they must be backed up with compelling data insights and professional data visualizations.



Steps for analysis this project:

* Ask
* Prepare
* Process
* Analyze
* Share
* Act

Road map of Case Study: 

* Used Code, if been generated
* Checklist of Key Task 
* Checklist of Deliverable


# Ask

Three questions will guide the future marketing program:

1. How do annual members and casual riders use Cyclistic bikes differently?
2. Why would casual riders buy Cyclistic annual memberships?
3. How can Cyclistic use digital media to influence casual riders to become members?

Marketing manager and manager Lilly Moreno assigned first question:

* How do annual members and casual riders use Cyclistic bikes differently?

#### Key Task:

* Recognize business tasks: 

The Main Subject is to design a new marketing strategy to convert casual riders into annual members

* Identify stakeholders:

1.Lily Moreno: The director of marketing and your manager

2.Cyclistic marketing analytics team: A team of data analysts who are responsible for collecting, analyzing, and reporting data.

#### Deliverable

* Statement of Business Tasks:
Identify differences between casual and subscriber (member) riders

## Prepare

To analyse and identify trends in this Project I will be use historical Trip Data of Company Cyclistic’s:

This data has been gathered and generated by Company Motivate International Inc.
Data is available here[link](https://www.divvybikes.com/data-license-agreement), with licence [link](https://divvy-tripdata.s3.amazonaws.com/index.html)

#### Key Task:

* Download data and store securely
This data has been downloaded and copy has been stored on my computer,

* How data is organized?
This data is CSV format,
Total columns number: 13
Column names:

  "ride_id", "rideable_type", "started_at", "ended_at",         
  "start_station_name", "start_station_id", "end_station_name",   
  "end_station_id", "start_lat", "start_lng", "end_lat", "end_lng",
  "member_casual"     

### Data structure: 
dbl, chr, date

* Organize data (sort and filter)


For this analysis, I am using historical data from January to December 2023.



* Credibility of the data:
For this project,the datasets are relevantand and will allow me to answer the business questions. Due to  data-privacy I cannot use secured informations of users and this will prevent me from determining if a single user/rider taken several rides. All users number ids are unique in this data.



* List of data sets what been used in this project
Source of data provided by Cycist company



### Download and combine data into single data frame



```{r}
## Installing packages

# install.packages("tidyverse")
# install.packages("janitor")
# download package geosphire and install
library(ggmap)
library(geosphere)
library(tidyverse)
library(readr)
library(lubridate)
library(ggplot2)
library(janitor)
library(dplyr)
library(rstudioapi)



jan23 <- read_csv("202301-divvy-tripdata.csv")
feb23 <- read_csv("202302-divvy-tripdata.csv")
mar23 <- read_csv("202303-divvy-tripdata.csv")
apr23 <- read_csv("202304-divvy-tripdata.csv")
may23 <- read_csv("202305-divvy-tripdata.csv")
jun23 <- read_csv("202306-divvy-tripdata.csv")
jul23 <- read_csv("202307-divvy-tripdata.csv")
aug23 <- read_csv("202308-divvy-tripdata.csv")
sep23 <- read_csv("202309-divvy-tripdata.csv")
oct23 <- read_csv("202310-divvy-tripdata.csv")
nov23 <- read_csv("202311-divvy-tripdata.csv")
dec23 <- read_csv("202312-divvy-tripdata.csv")

```

### Check consistency and structure of data sets

```{r}
names(jan23)
names(feb23)
names(mar23)
names(apr23)
names(may23)
names(jun23)
names(jul23)
names(aug23)
names(sep23)
names(oct23)
names(nov23)
names(dec23)

str(jan23)
str(feb23)
str(mar23)
str(apr23)
str(may23)
str(jun23)
str(jul23)
str(aug23)
str(sep23)
str(oct23)
str(nov23)
str(dec23)
```




### Merging process 
note: combining data from twelve months into one data sets, as this data is
consistent, columns name in single files are same named

```{r}
cyclist_data <- bind_rows(jan23, feb23, mar23, apr23, may23, jun23, jul23, aug23, sep23, oct23, nov23, dec23)
```




## Process

### Cleaning and prepare data 



#### Key Tasks:

* Checking errors in data
* Choosing tools
* Organise data to make it usable
* Documentation of cleaning data



#### Deliverable:

* Documentation of cleaning and manipulation data

```{r}
# Checking new data frame
colnames(cyclist_data)

```
```{r}
# Checking data type in new data frame
# in this data set we have data type chr,num and datetime format
str(cyclist_data)
```
```{r}
# view of column names in firsts rows of data frame

head(cyclist_data)

```

```{r}
# view of columns type 
str(cyclist_data)
```

```{r}
# numeric view of statistics of data
summary(cyclist_data)
```

### Data transformation 

Note: After view data, for metric measures of duration and period time,
I can see that data is in stamp format. For my analysis, I need to extract year,
month and day, in additional columns, also I need extract time from time stamp
format for length time measures.


```{r}
# Create aditional columns 'year','month','date' by extraction from time stamp.
# the columns extracted are started_at and ended_at

cyclist_data <- cyclist_data %>%

  mutate(year = format(as.Date(started_at),"%Y")) %>% 
  mutate(month = format(as.Date(started_at),"%B")) %>% 
  mutate(date = format(as.Date(started_at),"%D")) %>% 
  


  # created column day of week, extracted from timestamp column started_at
  
  mutate(week_day= format(as.Date(started_at),"%A")) %>%
  
  # creating new column of extracting difference time between ended_at and started_at
  
  mutate(time_ride = difftime(ended_at,started_at)) %>% 
  mutate(start_time = strftime(started_at,"%H")) 

```

note: created new column of start_time will show us which most time of day, the
rider use bikes




#### Convert time_ride 

note: new ride_time column is drtn, so for statistical measures
will convert it for numeric format

```{r}
cyclist_data <- cyclist_data %>% 
  mutate(time_ride = as.numeric(time_ride))
```




note: after conversion checking if the type of column is numeric

```{r}
is.numeric(cyclist_data$time_ride)
```
#### Creating column ride distance between to points in km




```{r}
# calculate distance and convert at km
cyclist_data$dystance_ride <- distGeo(matrix(c(cyclist_data$start_lng,
                                               cyclist_data$start_lat),ncol = 2),matrix(c(cyclist_data$end_lng,cyclist_data$end_lat),ncol = 2))

cyclist_data$dystance_ride <- cyclist_data$dystance_ride/1000 

```




#### Checks of negative or = 0 values, storage bad data in separate data frame as bad data

```{r}

bad_data <- filter(cyclist_data,time_ride<=0) 
select(bad_data,time_ride)
```

note: At this point, we can observe that our column time_ride have negative values or values = 0,
so we need remove this values




#### Removing bad data

```{r}
cyclist_data_cleaned <- cyclist_data[!(cyclist_data$time_ride<=0),]
```






## Analyze 



#### Key Task:

* Agregation data
* Organize and format data
* Perform calculations
* Identify trends and relationships

#### Deliverable:

* Outcome of analysis





 Checking cleaned data

```{r}
str(cyclist_data_cleaned)
```





Checking details of cleaned data


```{r}
summary(cyclist_data_cleaned)
```
## What has happened in the past by examining historical data patterns and trends - Conduct of descriptive analysis

For this point of analysis,I going to use mean will return average of total time ride/total users,median will return middle point of time ride, min will return min time ride, max will return maximum time ride




```{r}
cyclist_data_cleaned %>% 
  summarise(avg_time_ride=mean(time_ride),
            median_time_ride =median(time_ride),
            min_time_ride=min(time_ride),max_time_ride=max(time_ride))
```

Note: Above figures shows time_ride of whole 2023 year,Min and Max have strange values, which need to be analise in future.




### View on Riders types

Users difference of total trips taken

```{r}
cyclist_data_cleaned %>%
  group_by(member_casual) %>% 
  summarise(trips_taken = length(ride_id),
            trips_percentage = (length(ride_id)/nrow(cyclist_data_cleaned))*100)


ggplot(cyclist_data_cleaned,
       mapping = (aes(x=member_casual,fill= member_casual))) +
         geom_bar()+
         labs(x= "Caural vs Member",
              y= "Trips",
              title = "Casual vs Member ")+
  scale_y_continuous(labels =function(x)format(x,scientific=FALSE))
```

Note: We can observe on above chart, that  64% trips has been
done of members users,
and around 36% of trips has been done by casual users. We can see that members
used ride share 10% more than casual users




### Contrast between casual and members users to ride time 
in statistical measures:

```{r}
cyclist_data_cleaned %>% 
  group_by(member_casual) %>% 
  summarise(avg_time_ride = mean(time_ride),
            min_time_ride = min(time_ride),
            max_time_ride=max(time_ride))
 
```
note: This measures showing, that casual users took longer ride than members 
users, as average of members users is lowest than casual members.





### View of total trips and total trips timeof each day for casual
and member users
note: Order day from Monday to Sunday

```{r}
cyclist_data_cleaned$week_day <- ordered(cyclist_data_cleaned$week_day,
levels=c("Monday", "Tuesday", "Wednesday",
         "Thursday", "Friday", "Saturday","Sunday"))
```



```{r}
cyclist_data_cleaned %>% 
  group_by(member_casual,week_day) %>% # groping users
  summarise(count_of_trips=n(),
            avg_ride_time=mean(time_ride),.groups = "drop") %>% 
# calculate number trips and time of trips
  arrange(member_casual,week_day)

```




### Visualisate total numbers of trips gruped by users




```{r}
cyclist_data_cleaned %>% 
  group_by(member_casual,week_day) %>% # gruping users
  summarise(count_of_trips=n(),.groups = "drop") %>% 
# calculate number trips and time of trips
  arrange(member_casual,week_day) %>% 
  ggplot(aes(x=week_day,y=count_of_trips,fill = member_casual))+
           labs(title = "Total trips of users by day")+
           geom_col(width = 1,position = position_dodge(width= 1))+
                      scale_y_continuous(labels=function(x)format(x,scientific = FALSE))
  
  
```




### Visualisate average time ride

```{r}
cyclist_data_cleaned %>% 
  group_by(member_casual,week_day) %>% # gruping users
  summarise(count_of_trips=n(),avg_ride_time=mean(time_ride),.groups = "drop") %>% 
# calculate number trips and time of trips
  arrange(member_casual,week_day) %>% 
  ggplot(aes(x= week_day,y=avg_ride_time,fill=member_casual))+
  labs(title = "Average time trips of users by day")+
  geom_col(width = 1,position = position_dodge(width = 1))+
  scale_y_continuous(labels = function(x)format(x,scientific=FALSE))

```





Note: From first chart, we can observe that volume of renting bikes of casual
users, incise gradual from Monday to Saturday, then lowering on following day
Sunday. Regarding renting bikes of member users, the pick starts
on Tuesday to highest on Thursday and drooping down on Friday

From chart average time trips of users by day, we can observe that casual users
take trips most half longer than members users,the pick starts on Friday, and 
starts dropping down on Monday. Members users average time trips 
are in same range until Friday, when users have a little longer trips time.
We can observe very interesting negative correlation.

### Brakingdown facts:


Casual Riders:
Casual riders are individuals who use bike-sharing services 
occasionally or for leisure purposes. They might rent bikes for weekend outings,
exploring the city, or simply enjoying a ride.
Their ride durations tend to be longer,
possibly because they take their time,
stop for sightseeing, or enjoy a leisurely pace.


Members (Long-Term Users):
Members, on the other hand, are long-term users who have annual memberships. 
They use bikes more frequently, often for their daily commute, fitness, 
or regular transportation.
Their ride durations are typically shorter, 
as they have specific destinations and time constraints.

Correlation Type:
The correlation between ride duration and user type 
can be described as a negative correlation.
Specifically, as the user type shifts from casual riders to subscribers, 
the ride duration tends to decrease.
This negative correlation suggests that subscribers, 
who use bikes more frequently, complete their rides faster than casual riders.


Weekend Peaks:
The fact that both casual riders and subscribers experience high pick-up 
activity over the weekend indicates a common trend.
During weekends, more people, regardless of user type, choose bike rentals. 
This could be due to leisure activities, sightseeing, or recreational outings.

Practical Implications:
Bike-sharing services can use this information to:
Optimize Bike Placement: Install additional bikes at popular
pick-up spots during weekends to accommodate the increased demand.
Targeted Marketing: Tailor marketing campaigns to appeal to different customer
segments (casual riders vs. subscribers) based 
on their preferences and behaviors.

## Visualisate total trips count and time ride by months for casual and members
users

```{r}
# We need order months from January to December first 

cyclist_data_cleaned$month <- ordered(cyclist_data_cleaned$month,
                                      levels=c("January", "February",
                                               "March", "April", "May",
                                               "June", "July", "August",
                                               "September", "October",
                                               "November", "December"))

cyclist_data_cleaned %>% 
  group_by(member_casual,month) %>% 
  summarise(count_of_trips = n(),# count of number of trips
            avg_ride_time=mean(time_ride),.groups = "drop") %>% #avg time trips
  arrange(member_casual,month) %>% # sort by group of users and month
  ggplot(aes(x= month,y=count_of_trips ,fill = member_casual))+
  labs(title = "Count of trips for both usesrs by month",x= "Avg count trips",
       y= "Month")+
  theme(axis.text.x = element_text(angle = 35))+
  geom_col(width = 0.5, position = position_dodge(width = 0.5))+
 scale_y_continuous(labels = function(x) format(x,scientific  = FALSE))

                                      
```





### View of average time trips of users by month

```{r}
cyclist_data_cleaned %>% 
  group_by(member_casual,month) %>% 
  summarise(avg_ride_time= mean(time_ride),.groups = "drop") %>%
  ggplot(aes(x=month,y=avg_ride_time,fill=member_casual))+
  labs(title = "Average time trips of users by month",x="Month",y="Average time
       of trips")+
  theme(axis.text.x = element_text(angle = 35))+
  geom_col(width = 0.5,position = position_dodge(width = 0.5))+
  scale_y_continuous(labels = function(x)format(x,scientific=FALSE))
  
  
  
  
  
```






note:

Both casual users (represented in red) and member users (represented in teal) 
experience fluctuations in average trip times throughout the year.
During the summer months (June, July, August), there is a noticeable
increase in average trip times for both user categories.

Casual Users vs. Member Users:
Casual users tend to have longer average trip times
compared to member users across all months.
This suggests that casual riders take more leisurely 
rides, perhaps stopping to enjoy the scenery or explore the city.


Seasonal Influence:
The summer months coincide with longer daylight hours and pleasant
weather, which could explain the overall increase in trip times.
Member users, despite their shorter average trip times, also 
show an upward trend during summer.
Recommendations:
For casual riders, embracing the leisurely aspect 
of biking during favorable weather can enhance their
experience.


Member users might consider occasional longer rides to enjoy 
the benefits of cycling beyond their daily commute.
Its worth to look on other factors such as 
events, holidays, or local festivities
could also contribute to these patterns







### Trips distance of Members and Casual users

```{r}
cyclist_data_cleaned %>% drop_na() %>%
  # very important to use drop not available, as we can have empty chart
  group_by(member_casual) %>% 
  summarise(avg_distance_ride=mean(dystance_ride)) %>% 
  ggplot()+
  geom_col(mapping = aes(x=member_casual,y=avg_distance_ride,fill= member_casual),
show.legend=FALSE)+labs(title = "Average distance in Km of casual and members users",
                       x="member type", y= "avg distance in km")
```







Note: Above chart showing, that casual users have nearly same average same 
distance of trips, moreover the casual users take trips most in weekend time as
we seem in previous charts.





### Analisis and Visualisation of usage bike by hour

```{r}
cyclist_data_cleaned %>% 
 
  ggplot(aes(x=start_time,fill=member_casual))+
  labs(title = "usage bike by time of day",x="hour of day",y="number of users")+
  geom_bar()+scale_y_continuous(labels = function(x)format(x,scientific = FALSE))
```

note: 
Above chart showing us that both users taking trips mostly on working time and 
finish time of work,the highest pick we can observe between 8am-9am and 
5pm and 6pm.





Analyse and view using bike daily per hour

```{r}
cyclist_data_cleaned %>% 
  ggplot(aes(x=start_time,fill=member_casual))+geom_bar()+
  labs(title = "Usage bike by hour braking at day of week")+
  facet_wrap(~week_day)

```



note:

1.	Weekdays (Monday to Friday):
o	Morning Rush: People ride bikes more during the morning rush
hours (around 8 AM to 9 AM). Maybe they’re commuting to work or school.
o	Evening Rush: There’s another spike in bike usage during the evening
rush (around 5 PM to 6 PM). People are heading back home.
o	Good Weather: When the weather is nice, more bikes hit the road.


2.	Saturday:
Balanced day, Both casual riders and members enjoy biking.
* Afternoon Fun: Bike usage peaks in the early afternoon
(around 1 PM to 3 PM). Maybe folks are exploring the city or having
weekend adventures.


3.	Sunday:

*	People take it easy on Sundays.
*	Chill Vibes: Bike usage is lower overall, but there’s still
some riding happening.
*	Weather Matters: If it’s sunny, more bikes come out to play.







### Total trips of bike type used by Members and Casual users

```{r}
cyclist_data_cleaned %>% 
  group_by(rideable_type) %>% 
  summarise(number_of_trips= length(ride_id)) 


  ggplot(cyclist_data_cleaned,aes(x=rideable_type,fill=member_casual))+geom_bar()+
  labs(x= "bike type",title = "Total number of trips by type of bike used for casual and member
       users")+
    scale_y_continuous(labels = function(x)format(x,scientific = FALSE))

```







## Analyse most popular routes of type users using coorelate data
note: As company is based in Chicago, I will be use map of this town.




```{r}
# create new data frame for most popular routes taking by more than 150 users
favorite_routes <- cyclist_data_cleaned %>% 
  filter(start_lng != end_lng & start_lat != end_lat) %>% 
  group_by(start_lng,end_lng,start_lat,end_lat,member_casual,rideable_type) %>% 
  summarise(total_trips= n(),.groups = "drop") %>% 
  filter(total_trips >150)

```





Adding two new data frames of type users

```{r}
favorite_casual <- favorite_routes %>% 
  filter(member_casual=="casual")
favorite_member <- favorite_routes %>% 
  filter(member_casual=="member")
```





## Visualisation on map
note: For this project I will use Google map and store map of Chicago




### Favorite routes of Casual users 

```{r}
chicago_city <- c(long=-87.623177,lat=41.881832)
chicago_city_map <- get_map(location  = c(chicago_city),zoom =12,maptype = "terrain")

ggmap(chicago_city_map,darken = c(0.3, "white"))+geom_point(favorite_casual,mapping=aes(x=start_lng,y=start_lat,color=rideable_type),size=2)+
  coord_fixed(0.8)+labs(title = "Favorite routes used by casual users", x=NULL,y=NULL)+theme(legend.position = "none")
  
```







### Favorite routes of Member users

```{r}
ggmap(chicago_city_map,darken = c(0.1,"white"))+geom_point(favorite_member,mapping=aes(x=start_lng,y=start_lat,color=rideable_type),size=2)+
  coord_fixed(0.8)+labs(title = "Favorite routes used by member users",x=NULL,y=NULL)+
  theme(legend.position = "none")
```



This map shows the favorite routes used by member users,
scattered mostly around city center

As above charts shows, possible that members
users travelling to work,

Some of the routes pass by parks, stores, and other landmarks 
that might attract bike riders.





## Share 

This phase will be present to audience, as presentation, notebook in Markdown in
format HTML,PDF.

#### Key Tasks:

* Find way to share insights
* Create data visualizations
* Present insights
* Accessibility of work

#### Deliverable

* Visualizations and Key insights





### Insights and conclusions

* The member users total count trips is bigger of ~10% than casual users,in 
total count of trips of users,
* "Members" use bike more than casual users,
* Members users taking shorted trips, than casual users,average distance in km
nearly in same range, in addition casual users taking more longer trips over 
weekend period, when members taking shorted trips,
* On working week day Monday to Friday, both users taking trips in similar range
time: Morning rush between 7AM - 9AM and Afternoon Rush 5PM - 6PM,
* Over the Saturday both users types taking trips around 1PM 3PM, 
casual users taking trips more than member users,
on Sunday chart show that both riders type trips count are less,
moreover users taking rides.
* Electric bike is slightly popular by member users,than casual users.
Casual users slightly prefer casual bike trips, Docked bike type is most popular
by casual users.





### How members differ from casual users

* From Monday to Friday we can observe more activity of member users, casual
users use bikes on weekend in afternoon hours.
* Casual preffer taking longer trips, than members,
* We can observe, that average trip duration in nearly same, and little incrise
over the weekend,
* Members activity we can observe on morning time between 7 - 9 AM,where casual 
members are active more on afternoon hours from 12 -21 PM,
* Members slightly prefer electric bike, same as casuals,however docked bike is
mostly used by casual members
* Members used routine activity on bike on week work basis, when casual users are
more active over the weekend,
* Member users scattered over the city center, where casual around coast line,
parks,museums and green areas





## Act phase

This analyse point will be action by Data Driven Decision Making:
Cyclistic's executive team, Director of Marketing (Lily Moreno),
Marketing Analytics team based on my analyses

Recommendation based on Analysis

1.Show casual users how much they can save and enjoy by becoming members.
2.Send them messages that match their profile and goals.
3.Give them special offers and rewards for joining or inviting others.
4.Create marketing campaign based on most activity of casual users area,
 (Email or advertise the benefits of annual membership.in the busiest months)




### Additional data that could reach this analysis

* Member and casual rider prices - This data could help us 
cut costs or offer discounts without losing profit,

* Member locations to see if any area factors boost membership,

* How to identify repeat bike users from payment or personal data









Source: * RStudio
        * R Documentation
        * Kaggle Community
        






